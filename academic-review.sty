\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{academic-review}[2024/11/05 Review Response Template]

% Required packages
\RequirePackage[T1]{fontenc}
\RequirePackage{amsmath}
\RequirePackage{mdframed}
\RequirePackage{newtxtext}
\RequirePackage{titlesec}
\RequirePackage{ulem}
\RequirePackage{xcolor}
\RequirePackage{parskip}
\RequirePackage{hyperref}
\RequirePackage{graphicx}
\RequirePackage{microtype}
\RequirePackage{tabularray}
\RequirePackage{pgfmath}
\RequirePackage[a4paper, total={6in, 10in}]{geometry}

% Paragraph formatting
\setlength{\parindent}{0pt}
\setlength{\parskip}{0.75em}

% Section spacing and formatting
\titlespacing*{\section}{0pt}{0.75em}{0.5em}

\titleformat{\section}
    {\normalfont\fontsize{15}{17}\bfseries}
    {\thesection}
    {1em}
    {}
    []

\titleformat{\subsection}
    {\normalfont\fontsize{14}{17}\bfseries}
    {\thesubsection}
    {1em}
    {}
    []

% Custom commands for review responses
\newcommand{\del}[1]{\textcolor{red}{\sout{#1}}}
\newcommand{\RC}[1]{\hspace{-2.5em}\textbf{RC:}\hspace{0.7em}\textit{#1}}
\newcommand{\AR}{\hspace{-2.5em}\textbf{AR:}\hspace{0.6em}}

% Title page commands
\renewcommand{\title}[1]{%
    \LARGE\textbf{Authors' Response to Reviews of}
    
    \vspace{0.1em}
    \Large\textbf{#1}%
}

\newcommand{\authors}[1]{#1}

\newcommand{\journal}[2]{\textit{#1, \textbf{#2}}}

\newcommand{\therule}{
    \vspace{-0.75em}
    \noindent\rule{6in}{0.5pt}
}

\newcommand{\header}{%
    \therule
    \textbf{RC}: Reviewers' Comment \quad \textbf{AR}: Authors' Response
}

\newcommand{\helper}{\textit{Numbering to figures, tables, references, and equations are to the original manuscript. Framed texts are direct modifications to the manuscript, starting by the page number pointing to the new manuscript.}}

\newcommand{\important}[1]{\textcolor{red}{#1}}

\newcommand{\note}[1]{#1}

\newcounter{reviewernumber}
\setcounter{reviewernumber}{0}

\newcounter{commentnumber}
\setcounter{commentnumber}{0}

\newcommand{\newreviewer}{%
    \setcounter{commentnumber}{0}%
    \therule
    \stepcounter{reviewernumber}%
    \section*{Reviewer \#\arabic{reviewernumber}}%
}

\newcommand{\newcomment}{%
    \stepcounter{commentnumber}%
    \subsection*{Comment \#\arabic{commentnumber}.}%
}

\newenvironment{changes}[1][]{%
    \begin{mdframed}
    \ifx\\#1\\% If no parameter or empty
    % Do nothing
    \else%
        \textbf{Page #1.}% The ~ prevents unwanted line break
    \fi%
}{%
    \end{mdframed}%
}

% Define response templates
\newcommand{\responseA}{We thank the reviewer for their insightful comment. }
\newcommand{\responseB}{We appreciate the reviewer's valuable feedback. }
\newcommand{\responseC}{We wish to thank the reviewer for their response. }
\newcommand{\responseD}{We express our thanks for the reviewer's remarks. }
\newcommand{\responseE}{The reviewer's comment is appreciated. }
\newcommand{\responseF}{We acknowledge this valuable comment from the reviewer. }
\newcommand{\responseG}{We thank the reviewer for their constructive feedback. }
\newcommand{\responseH}{Thanks are extended to the reviewer for their comment. }
\newcommand{\responseI}{The reviewer's input warrants our appreciation. }
\newcommand{\responseJ}{Our thanks go to the reviewer for their feedback. }
\newcommand{\responseK}{Gratitude is expressed to the reviewer for their comment. }
\newcommand{\responseL}{The reviewer's remarks are acknowledged with thanks.}
\newcommand{\responseM}{Due appreciation is extended for the reviewer's feedback. }
\newcommand{\responseN}{Many thanks to the reviewer for their contribution. }
\newcommand{\responseO}{Sincere thanks to the reviewer for their input. }
\newcommand{\responseP}{The feedback provided by the reviewer is appreciated. }
\newcommand{\responseQ}{Our gratitude is extended to the reviewer for their comment. }

% Random response generator command
\newcommand{\randomthanks}{%
  \pgfmathsetmacro{\responsenum}{int(random(0,17))}%
  \ifcase\responsenum
    \responseA
  \or
    \responseB
  \or
    \responseC
  \or
    \responseD
  \or
    \responseE
  \or
    \responseF
  \or
    \responseG
  \or
    \responseH
  \or
    \responseI
  \or
    \responseJ
  \or
    \responseK
  \or
    \responseL
  \or
    \responseM
  \or
    \responseN
  \or
    \responseO
  \or
    \responseP
  \or
    \responseQ
  \fi
}